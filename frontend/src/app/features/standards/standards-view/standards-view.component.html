<div class="standards-container">
  <div class="standards-header">
    <h1>Strength Standards</h1>
    <p>Compare your strength levels to established standards for your gender and weight</p>
  </div>
  
  <div *ngIf="loading" class="loading-spinner">
    <div class="spinner-border" role="status">
      <span class="sr-only">Loading...</span>
    </div>
  </div>
  
  <div *ngIf="!loading" class="standards-content">
    <div class="standards-form-card">
      <h2>Check Your Strength Level</h2>
      
      <form [formGroup]="standardsForm" (ngSubmit)="onSubmit()">
        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="exercise">Exercise</label>
            <select 
              formControlName="exercise" 
              class="form-control" 
              [ngClass]="{ 'is-invalid': f['exercise'].touched && f['exercise'].errors }"
            >
              <option value="">Select Exercise</option>
              <option *ngFor="let exercise of exercises" [value]="exercise._id">{{ exercise.name }}</option>
            </select>
            <div *ngIf="f['exercise'].touched && f['exercise'].errors" class="invalid-feedback">
              <div *ngIf="f['exercise'].errors['required']">Exercise is required</div>
            </div>
          </div>
          
          <div class="form-group col-md-6">
            <label for="oneRM">Your One-Rep Max (kg)</label>
            <input 
              type="number" 
              formControlName="oneRM" 
              class="form-control" 
              [ngClass]="{ 'is-invalid': f['oneRM'].touched && f['oneRM'].errors }" 
            />
            <div *ngIf="f['oneRM'].touched && f['oneRM'].errors" class="invalid-feedback">
              <div *ngIf="f['oneRM'].errors['required']">One-Rep Max is required</div>
              <div *ngIf="f['oneRM'].errors['min']">One-Rep Max must be greater than 0</div>
            </div>
          </div>
        </div>
        
        <div class="form-actions">
          <button type="submit" [disabled]="standardsForm.invalid || loading" class="btn btn-primary">
            <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>
            Check Strength Level
          </button>
        </div>
      </form>
    </div>
    
    <div *ngIf="selectedStandard" class="standards-result-card">
      <h2>Your Strength Level</h2>
      
      <div class="user-info">
        <div class="user-stat">
          <span class="stat-label">Exercise:</span>
          <span class="stat-value">{{ selectedStandard.exercise.name }}</span>
        </div>
        
        <div class="user-stat">
          <span class="stat-label">Your Weight:</span>
          <span class="stat-value">{{ userWeight }} kg</span>
        </div>
        
        <div class="user-stat">
          <span class="stat-label">Your 1RM:</span>
          <span class="stat-value">{{ userOneRM }} kg</span>
        </div>
      </div>
      
      <div class="strength-level-result">
        <h3>You are at <span class="level-highlight">{{ userLevel | titlecase }}</span> level</h3>
        
        <div class="strength-bar-container">
          <div class="strength-levels">
            <div class="level" [ngClass]="{'active': userLevel === 'beginner'}">Beginner</div>
            <div class="level" [ngClass]="{'active': userLevel === 'novice'}">Novice</div>
            <div class="level" [ngClass]="{'active': userLevel === 'intermediate'}">Intermediate</div>
            <div class="level" [ngClass]="{'active': userLevel === 'advanced'}">Advanced</div>
            <div class="level" [ngClass]="{'active': userLevel === 'elite'}">Elite</div>
          </div>
          
          <div class="strength-bar">
            <div class="progress-bar" [style.width.%]="userPercentage"></div>
          </div>
          
          <div class="percentiles">
            <div class="percentile-info">
              <div class="percentile-label">Progress to {{ getNextLevel() | titlecase }}:</div>
              <div class="percentile-value">{{ userPercentage | number:'1.0-0' }}%</div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="standards-table">
        <h3>Strength Standards for {{ selectedStandard.exercise.name }} ({{ selectedStandard.gender | titlecase }})</h3>
        
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Weight Class</th>
                <th>Beginner</th>
                <th>Novice</th>
                <th>Intermediate</th>
                <th>Advanced</th>
                <th>Elite</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let category of selectedStandard.weightCategories" [ngClass]="{'highlighted': userWeight >= category.minWeight && userWeight <= category.maxWeight}">
                <td>{{ category.minWeight }}-{{ category.maxWeight }} kg</td>
                <td>{{ category.strengthLevels.beginner }} kg</td>
                <td>{{ category.strengthLevels.novice }} kg</td>
                <td>{{ category.strengthLevels.intermediate }} kg</td>
                <td>{{ category.strengthLevels.advanced }} kg</td>
                <td>{{ category.strengthLevels.elite }} kg</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    
    <div *ngIf="!selectedStandard && !loading && exercises.length > 0" class="standards-info-card">
      <h2>About Strength Standards</h2>
      
      <p>Strength standards are benchmarks that help you gauge your strength level compared to others of similar body weight and gender. They provide a way to track your progress and set realistic goals.</p>
      
      <div class="strength-levels-info">
        <div class="level-info">
          <h3>Beginner</h3>
          <p>You have been training for less than a year and are still learning proper form and technique.</p>
        </div>
        
        <div class="level-info">
          <h3>Novice</h3>
          <p>You have been training consistently for at least 6 months and have developed basic strength.</p>
        </div>
        
        <div class="level-info">
          <h3>Intermediate</h3>
          <p>You have been training consistently for 1-2 years and have developed good strength.</p>
        </div>
        
        <div class="level-info">
          <h3>Advanced</h3>
          <p>You have been training consistently for 2-4 years and have developed very good strength.</p>
        </div>
        
        <div class="level-info">
          <h3>Elite</h3>
          <p>You have been training consistently for 4+ years and have developed exceptional strength.</p>
        </div>
      </div>
    </div>
    
    <div *ngIf="!loading && exercises.length === 0" class="no-data">
      <p>No strength standards available. Please contact an administrator to add strength standards.</p>
    </div>
    
    <div *ngIf="error" class="alert alert-danger mt-3">
      {{ error }}
    </div>
  </div>
</div>
