<div class="admin-container">
  <div class="admin-header">
    <h1>Exercise Management</h1>
    <p>Create, edit, and manage exercises in the database</p>
  </div>
  
  <div class="admin-content">
    <div class="admin-card">
      <h2>{{ editMode ? 'Edit Exercise' : 'Add New Exercise' }}</h2>
      
      <form [formGroup]="exerciseForm" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="name">Exercise Name</label>
          <input 
            type="text" 
            formControlName="name" 
            class="form-control" 
            [ngClass]="{ 'is-invalid': f['name'].touched && f['name'].errors }" 
          />
          <div *ngIf="f['name'].touched && f['name'].errors" class="invalid-feedback">
            <div *ngIf="f['name'].errors['required']">Exercise name is required</div>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="muscleGroup">Muscle Group</label>
            <select 
              formControlName="muscleGroup" 
              class="form-control" 
              [ngClass]="{ 'is-invalid': f['muscleGroup'].touched && f['muscleGroup'].errors }"
            >
              <option value="">Select Muscle Group</option>
              <option value="chest">Chest</option>
              <option value="back">Back</option>
              <option value="shoulders">Shoulders</option>
              <option value="arms">Arms</option>
              <option value="legs">Legs</option>
              <option value="core">Core</option>
              <option value="full body">Full Body</option>
            </select>
            <div *ngIf="f['muscleGroup'].touched && f['muscleGroup'].errors" class="invalid-feedback">
              <div *ngIf="f['muscleGroup'].errors['required']">Muscle group is required</div>
            </div>
          </div>
          
          <div class="form-group col-md-6">
            <label for="movementType">Movement Type</label>
            <select 
              formControlName="movementType" 
              class="form-control" 
              [ngClass]="{ 'is-invalid': f['movementType'].touched && f['movementType'].errors }"
            >
              <option value="">Select Movement Type</option>
              <option value="push">Push</option>
              <option value="pull">Pull</option>
              <option value="squat">Squat</option>
              <option value="hinge">Hinge</option>
              <option value="carry">Carry</option>
              <option value="rotation">Rotation</option>
              <option value="isometric">Isometric</option>
            </select>
            <div *ngIf="f['movementType'].touched && f['movementType'].errors" class="invalid-feedback">
              <div *ngIf="f['movementType'].errors['required']">Movement type is required</div>
            </div>
          </div>
        </div>
        
        <div class="form-group">
          <label for="description">Description</label>
          <textarea 
            formControlName="description" 
            class="form-control" 
            rows="3"
          ></textarea>
        </div>
        
        <div class="form-row checkbox-row">
          <div class="form-check">
            <input 
              type="checkbox" 
              formControlName="isCompound" 
              class="form-check-input" 
              id="isCompound"
            />
            <label class="form-check-label" for="isCompound">Compound Exercise</label>
          </div>
          
          <div class="form-check">
            <input 
              type="checkbox" 
              formControlName="isPowerlifting" 
              class="form-check-input" 
              id="isPowerlifting"
            />
            <label class="form-check-label" for="isPowerlifting">Powerlifting Exercise</label>
          </div>
        </div>
        
        <div class="form-actions">
          <button type="submit" [disabled]="exerciseForm.invalid || loading" class="btn btn-primary">
            <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>
            {{ editMode ? 'Update Exercise' : 'Add Exercise' }}
          </button>
          
          <button *ngIf="editMode" type="button" class="btn btn-outline-secondary" (click)="resetForm()">
            Cancel
          </button>
        </div>
      </form>
      
      <div *ngIf="submitSuccess" class="alert alert-success mt-3">
        Exercise {{ editMode ? 'updated' : 'added' }} successfully!
      </div>
      
      <div *ngIf="error" class="alert alert-danger mt-3">
        {{ error }}
      </div>
    </div>
    
    <div class="admin-card mt-4">
      <div class="card-header-with-search">
        <h2>Exercise List</h2>
        
        <div class="search-box">
          <input 
            type="text" 
            [(ngModel)]="searchTerm" 
            (input)="onSearchChange()" 
            placeholder="Search exercises..." 
            class="form-control"
          />
        </div>
      </div>
      
      <div *ngIf="loadingExercises" class="loading-spinner">
        <div class="spinner-border" role="status">
          <span class="sr-only">Loading...</span>
        </div>
      </div>
      
      <div *ngIf="!loadingExercises && filteredExercises.length === 0" class="no-data">
        <p>No exercises found. Add your first exercise using the form above.</p>
      </div>
      
      <div *ngIf="!loadingExercises && filteredExercises.length > 0" class="exercise-list">
        <div *ngFor="let exercise of filteredExercises" class="exercise-item">
          <div class="exercise-details">
            <h3>{{ exercise.name }}</h3>
            <div class="exercise-meta">
              <span class="badge badge-primary">{{ exercise.muscleGroup | titlecase }}</span>
              <span class="badge badge-secondary">{{ exercise.movementType | titlecase }}</span>
              <span *ngIf="exercise.isCompound" class="badge badge-info">Compound</span>
              <span *ngIf="exercise.isPowerlifting" class="badge badge-success">Powerlifting</span>
            </div>
            <p *ngIf="exercise.description" class="exercise-description">{{ exercise.description }}</p>
          </div>
          
          <div class="exercise-actions">
            <button class="btn btn-sm btn-outline-primary" (click)="editExercise(exercise)">
              Edit
            </button>
            <button class="btn btn-sm btn-outline-danger" (click)="confirmDeleteExercise(exercise)">
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Delete Confirmation Modal -->
  <div *ngIf="confirmDelete" class="modal-overlay">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Confirm Delete</h5>
          <button type="button" class="close" (click)="cancelDelete()">
            <span>&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete the exercise "{{ exerciseToDelete?.name }}"?</p>
          <p class="text-danger">This action cannot be undone.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary" (click)="cancelDelete()">Cancel</button>
          <button type="button" class="btn btn-danger" [disabled]="loading" (click)="deleteExercise()">
            <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>
            Delete
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
